import{j as e,S as es,L as Ee,T as Re,C as _e,R as ss,U as Me,A as ae,F as as,a as xe,b as Ae,c as ts,X as rs,B as le,d as $e,I as ns,e as ls,P as is,f as Le,V as cs,g as Oe,h as Ue,i as ds,k as os,l as ms,m as Be,n as xs,o as us,p as hs,q as ue,r as Ye,s as ze,t as He,u as qe,v as gs,w as fs,x as Je,y as Ge,z as Ke,D as ps,E as js,G as Ns,H as de}from"./ui-C_Zih_N0.js";import{b as bs,r as i,R as vs}from"./vendor-DB9HQzDI.js";import{t as ys,c as We,P as ks}from"./utils-GaJ1HoMq.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const j of document.querySelectorAll('link[rel="modulepreload"]'))h(j);new MutationObserver(j=>{for(const N of j)if(N.type==="childList")for(const w of N.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&h(w)}).observe(document,{childList:!0,subtree:!0});function r(j){const N={};return j.integrity&&(N.integrity=j.integrity),j.referrerPolicy&&(N.referrerPolicy=j.referrerPolicy),j.crossOrigin==="use-credentials"?N.credentials="include":j.crossOrigin==="anonymous"?N.credentials="omit":N.credentials="same-origin",N}function h(j){if(j.ep)return;j.ep=!0;const N=r(j);fetch(j.href,N)}})();var Se={},Ie=bs;Se.createRoot=Ie.createRoot,Se.hydrateRoot=Ie.hydrateRoot;function k(...n){return ys(We(n))}const A=i.forwardRef(({className:n,...a},r)=>e.jsx("div",{ref:r,className:k("rounded-lg border bg-card text-card-foreground shadow-sm",n),...a}));A.displayName="Card";const D=i.forwardRef(({className:n,...a},r)=>e.jsx("div",{ref:r,className:k("flex flex-col space-y-1.5 p-6",n),...a}));D.displayName="CardHeader";const E=i.forwardRef(({className:n,...a},r)=>e.jsx("h3",{ref:r,className:k("text-2xl font-semibold leading-none tracking-tight",n),...a}));E.displayName="CardTitle";const ws=i.forwardRef(({className:n,...a},r)=>e.jsx("p",{ref:r,className:k("text-sm text-muted-foreground",n),...a}));ws.displayName="CardDescription";const I=i.forwardRef(({className:n,...a},r)=>e.jsx("div",{ref:r,className:k("p-6 pt-0",n),...a}));I.displayName="CardContent";const Ss=i.forwardRef(({className:n,...a},r)=>e.jsx("div",{ref:r,className:k("flex items-center p-6 pt-0",n),...a}));Ss.displayName="CardFooter";const Fe=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,Te=We,Ze=(n,a)=>r=>{var h;if((a==null?void 0:a.variants)==null)return Te(n,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:j,defaultVariants:N}=a,w=Object.keys(j).map(v=>{const y=r==null?void 0:r[v],g=N==null?void 0:N[v];if(y===null)return null;const L=Fe(y)||Fe(g);return j[v][L]}),O=r&&Object.entries(r).reduce((v,y)=>{let[g,L]=y;return L===void 0||(v[g]=L),v},{}),F=a==null||(h=a.compoundVariants)===null||h===void 0?void 0:h.reduce((v,y)=>{let{class:g,className:L,...R}=y;return Object.entries(R).every(q=>{let[P,J]=q;return Array.isArray(J)?J.includes({...N,...O}[P]):{...N,...O}[P]===J})?[...v,g,L]:v},[]);return Te(n,w,F,r==null?void 0:r.class,r==null?void 0:r.className)},Cs=Ze("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary",facebook:"bg-facebook-500 text-white hover:bg-facebook-600"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),M=i.forwardRef(({className:n,variant:a,size:r,asChild:h=!1,...j},N)=>{const w=h?es:"button";return e.jsx(w,{className:k(Cs({variant:a,size:r,className:n})),ref:N,...j})});M.displayName="Button";const Ps=ss,Xe=i.forwardRef(({className:n,...a},r)=>e.jsx(Ee,{ref:r,className:k("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",n),...a}));Xe.displayName=Ee.displayName;const oe=i.forwardRef(({className:n,...a},r)=>e.jsx(Re,{ref:r,className:k("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",n),...a}));oe.displayName=Re.displayName;const me=i.forwardRef(({className:n,...a},r)=>e.jsx(_e,{ref:r,className:k("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...a}));me.displayName=_e.displayName;const Vs=Ze("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",success:"border-green-500/50 text-green-600 dark:text-green-400 [&>svg]:text-green-600",info:"border-facebook-300/50 text-facebook-600 dark:text-facebook-400 [&>svg]:text-facebook-600"}},defaultVariants:{variant:"default"}}),K=i.forwardRef(({className:n,variant:a,...r},h)=>e.jsx("div",{ref:h,role:"alert",className:k(Vs({variant:a}),n),...r}));K.displayName="Alert";const W=i.forwardRef(({className:n,...a},r)=>e.jsx("h5",{ref:r,className:k("mb-1 font-medium leading-none tracking-tight",n),...a}));W.displayName="AlertTitle";const Z=i.forwardRef(({className:n,...a},r)=>e.jsx("div",{ref:r,className:k("text-sm [&_p]:leading-relaxed",n),...a}));Z.displayName="AlertDescription";const De=["Page","Page ID","Reach","Engaged Users","Engagements","Reactions","Publications","Status","Comment"];function Ms({onDataUploaded:n,onCancel:a}){const[r,h]=i.useState([]),[j,N]=i.useState(!1),[w,O]=i.useState(!1),[F,v]=i.useState([]),[y,g]=i.useState({}),L=i.useRef(null),R=m=>{const b=/^FB_(\d{4})_(\d{2})\.csv$/,s=m.match(b);if(!s)return{isValid:!1,error:"Felaktigt filnamnsformat. Förväntat: FB_YYYY_MM.csv (t.ex. FB_2025_08.csv)"};const l=parseInt(s[1]),o=parseInt(s[2]);return o<1||o>12?{isValid:!1,error:"Ogiltig månad. Måste vara mellan 01-12."}:l<2020||l>2030?{isValid:!1,error:"Ogiltigt år. Måste vara mellan 2020-2030."}:{isValid:!0,year:l,month:o,displayName:`${q(o)} ${l}`}},q=m=>["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"][m-1],P=(m,b)=>new Promise(s=>{ks.parse(m,{header:!0,skipEmptyLines:!0,complete:l=>{if(l.errors.length>0){s({isValid:!1,error:`CSV-parsningsfel: ${l.errors[0].message}`,data:null});return}const o=l.meta.fields||[],u=De.filter(d=>!o.includes(d));if(u.length>0){s({isValid:!1,error:`Saknade kolumner: ${u.join(", ")}`,data:null});return}if(l.data.length===0){s({isValid:!1,error:"CSV-filen innehåller ingen data",data:null});return}s({isValid:!0,data:l.data,pageCount:l.data.length,error:null})}})}),J=m=>{m.preventDefault(),m.stopPropagation(),O(!1);const b=Array.from(m.dataTransfer.files),s=b.filter(l=>l.name.toLowerCase().endsWith(".csv"));s.length!==b.length&&v(l=>[...l,"Endast CSV-filer är tillåtna"]),s.length>0&&X(s)},V=m=>{const b=Array.from(m.target.files);X(b)},X=m=>{const b=m.map(u=>{const d=R(u.name);return{file:u,id:Math.random().toString(36),name:u.name,size:u.size,validation:d,status:d.isValid?"pending":"error"}}),s=r.map(u=>u.name),l=b.filter(u=>s.includes(u.name));l.length>0&&v(u=>[...u,`Följande filer är redan valda: ${l.map(d=>d.name).join(", ")}`]);const o=b.filter(u=>!s.includes(u.name));h(u=>[...u,...o])},T=m=>{h(b=>b.filter(s=>s.id!==m))},G=async()=>{N(!0),v([]),g({});const m=r.filter(s=>s.validation.isValid),b=[];for(const s of m){g(l=>({...l,[s.id]:"processing"}));try{const l=await U(s.file),o=await P(l,s.name);if(!o.isValid){g(d=>({...d,[s.id]:"error"})),v(d=>[...d,`${s.name}: ${o.error}`]);continue}const u={...s.validation,data:o.data,pageCount:o.pageCount,filename:s.name};b.push(u),g(d=>({...d,[s.id]:"success"})),await new Promise(d=>setTimeout(d,500))}catch(l){g(o=>({...o,[s.id]:"error"})),v(o=>[...o,`${s.name}: ${l.message}`])}}N(!1),b.length>0&&n(b)},U=m=>new Promise((b,s)=>{const l=new FileReader;l.onload=o=>b(o.target.result),l.onerror=()=>s(new Error("Kunde inte läsa fil")),l.readAsText(m)}),z=m=>{m.preventDefault(),m.stopPropagation(),O(!0)},Q=m=>{m.preventDefault(),m.stopPropagation(),O(!1)},te=()=>{v([])},H=r.filter(m=>m.validation.isValid).length,B=H>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-5 w-5 text-facebook-500"}),"Ladda upp Facebook CSV-filer"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Släpp dina FB_YYYY_MM.csv filer här eller klicka för att välja filer"})]}),e.jsx(I,{children:e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer ${w?"border-facebook-400 bg-facebook-50":"border-gray-300 hover:border-facebook-400 hover:bg-facebook-50"}`,onDrop:J,onDragOver:z,onDragLeave:Q,onClick:()=>{var m;return(m=L.current)==null?void 0:m.click()},children:[e.jsx("input",{type:"file",ref:L,onChange:V,multiple:!0,accept:".csv",className:"hidden"}),e.jsx(Me,{className:"h-12 w-12 mx-auto mb-4 text-facebook-400"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:w?"Släpp filerna här":"Ladda upp CSV-filer"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Släpp dina FB_YYYY_MM.csv filer här eller klicka för att välja"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Format:"})," FB_YYYY_MM.csv (t.ex. FB_2025_08.csv)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Kolumner:"})," ",De.join(", ")]})]})]})})]}),F.length>0&&e.jsxs(K,{variant:"destructive",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(W,{children:"Valideringsfel"}),e.jsxs(Z,{children:[e.jsx("ul",{className:"list-disc list-inside space-y-1",children:F.map((m,b)=>e.jsx("li",{children:m},b))}),e.jsx(M,{variant:"outline",size:"sm",onClick:te,className:"mt-2",children:"Rensa fel"})]})]}),r.length>0&&e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs(E,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Valda filer (",r.length,")"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[H," giltiga filer"]})]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-2",children:r.map(m=>{const b=y[m.id]||m.status;return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${m.validation.isValid?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(as,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:m.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:m.validation.isValid?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),m.validation.displayName]}):e.jsx("span",{className:"text-red-600",children:m.validation.error})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[b==="processing"&&e.jsx(Ae,{className:"h-4 w-4 animate-spin text-blue-500"}),b==="success"&&e.jsx(ts,{className:"h-4 w-4 text-green-500"}),b==="error"&&e.jsx(ae,{className:"h-4 w-4 text-red-500"}),e.jsx(M,{variant:"ghost",size:"sm",onClick:()=>T(m.id),disabled:j,children:e.jsx(rs,{className:"h-4 w-4"})})]})]},m.id)})})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(M,{variant:"outline",onClick:a,disabled:j,children:"Avbryt"}),e.jsxs("div",{className:"flex gap-2",children:[r.length>0&&e.jsx(M,{variant:"outline",onClick:()=>h([]),disabled:j,children:"Rensa alla"}),e.jsx(M,{onClick:G,disabled:!B||j,className:"min-w-[120px]",children:j?e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"mr-2 h-4 w-4 animate-spin"}),"Bearbetar..."]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Analysera data (",H,")"]})})]})]})]})}const Ce=i.forwardRef(({className:n,...a},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:k("w-full caption-bottom text-sm",n),...a})}));Ce.displayName="Table";const Pe=i.forwardRef(({className:n,...a},r)=>e.jsx("thead",{ref:r,className:k("[&_tr]:border-b",n),...a}));Pe.displayName="TableHeader";const Ve=i.forwardRef(({className:n,...a},r)=>e.jsx("tbody",{ref:r,className:k("[&_tr:last-child]:border-0",n),...a}));Ve.displayName="TableBody";const he=i.forwardRef(({className:n,...a},r)=>e.jsx("tr",{ref:r,className:k("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...a}));he.displayName="TableRow";const ge=i.forwardRef(({className:n,...a},r)=>e.jsx("th",{ref:r,className:k("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",n),...a}));ge.displayName="TableHead";const fe=i.forwardRef(({className:n,...a},r)=>e.jsx("td",{ref:r,className:k("p-4 align-middle [&:has([role=checkbox])]:pr-0",n),...a}));fe.displayName="TableCell";const ve=xs,ye=us,pe=i.forwardRef(({className:n,children:a,...r},h)=>e.jsxs($e,{ref:h,className:k("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),...r,children:[a,e.jsx(ns,{asChild:!0,children:e.jsx(ls,{className:"h-4 w-4 opacity-50"})})]}));pe.displayName=$e.displayName;const je=i.forwardRef(({className:n,children:a,position:r="popper",...h},j)=>e.jsx(is,{children:e.jsx(Le,{ref:j,className:k("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:r,...h,children:e.jsx(cs,{className:k("p-1 max-h-[300px] overflow-y-auto",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a})})}));je.displayName=Le.displayName;const As=i.forwardRef(({className:n,...a},r)=>e.jsx(Oe,{ref:r,className:k("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...a}));As.displayName=Oe.displayName;const Ne=i.forwardRef(({className:n,children:a,...r},h)=>e.jsxs(Ue,{ref:h,className:k("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ds,{children:e.jsx(os,{className:"h-4 w-4"})})}),e.jsx(ms,{children:a})]}));Ne.displayName=Ue.displayName;const Is=i.forwardRef(({className:n,...a},r)=>e.jsx(Be,{ref:r,className:k("-mx-1 my-1 h-px bg-muted",n),...a}));Is.displayName=Be.displayName;const Fs=[{value:6,label:"6 per sida"},{value:12,label:"12 per sida"},{value:24,label:"24 per sida"}],Ts=[{key:"reach",label:"Räckvidd",canSum:!1},{key:"engagements",label:"Engagemang",canSum:!0},{key:"reactions",label:"Reaktioner",canSum:!0},{key:"publications",label:"Publiceringar",canSum:!0}],be={reach:{displayName:"Räckvidd",canSumAcrossPages:!1,category:"unique_persons"},engagements:{displayName:"Engagemang",canSumAcrossPages:!0,category:"countable"},reactions:{displayName:"Reaktioner",canSumAcrossPages:!0,category:"countable"},publications:{displayName:"Publiceringar",canSumAcrossPages:!0,category:"countable"}};function Ds({uploadedPeriods:n=[]}){const[a,r]=i.useState([]),[h,j]=i.useState(""),[N,w]=i.useState([]),[O,F]=i.useState(!0),[v,y]=i.useState(null),[g,L]=i.useState(null),[R,q]=i.useState({}),[P,J]=i.useState({key:"year_month",direction:"desc"}),[V,X]=i.useState(1),[T,G]=i.useState(12),[U,z]=i.useState(["reach","engagements","publications"]);i.useEffect(()=>{(()=>{try{if(F(!0),n.length===0){r([]),F(!1);return}const c=new Map;n.forEach(f=>{f.data&&Array.isArray(f.data)&&f.data.forEach(p=>{const S=p.Page||p.page||"Okänd sida",Y=p["Page ID"]||p.pageId||`page_${S.replace(/\s+/g,"_")}`;c.has(Y)||c.set(Y,{pageId:Y,pageName:S})})});const x=Array.from(c.values()).sort((f,p)=>f.pageName.localeCompare(p.pageName));r(x),x.length>0&&j(x[0].pageId)}catch(c){console.error("Error loading pages:",c),y("Kunde inte ladda tillgängliga Facebook-sidor")}finally{F(!1)}})()},[n]),i.useEffect(()=>{if(!h||n.length===0)return;(()=>{try{F(!0),y(null);const c=[];if(n.forEach(f=>{if(f.data&&Array.isArray(f.data)){const p=f.data.find(S=>(S["Page ID"]||S.pageId||`page_${(S.Page||S.page||"").replace(/\s+/g,"_")}`)===h);p&&c.push({year:f.year,month:f.month,pageName:p.Page||p.page||"Okänd sida",pageId:h,metrics:{reach:Q(p.Reach||p.reach),engagements:Q(p.Engagements||p.engagements),reactions:Q(p.Reactions||p.reactions),publications:Q(p.Publications||p.publications)}})}}),c.length===0){const f=a.find(p=>p.pageId===h);y(`Ingen tidserie-data hittades för ${(f==null?void 0:f.pageName)||"vald sida"}`);return}const x=c.sort((f,p)=>f.year!==p.year?p.year-f.year:p.month-f.month);w(x),te(x)}catch(c){console.error("Error loading page timeseries:",c);const x=a.find(f=>f.pageId===h);y(`Kunde inte ladda data för ${(x==null?void 0:x.pageName)||"vald sida"}`)}finally{F(!1)}})()},[h,n,a]);const Q=t=>{if(t==null||t==="")return 0;const c=parseFloat(String(t).replace(/[,\s]/g,""));return isNaN(c)?0:c},te=t=>{var S,Y,re;if(t.length===0)return;const c=a.find(C=>C.pageId===h),x={pageName:(c==null?void 0:c.pageName)||((S=t[0])==null?void 0:S.pageName)||"Okänd sida",totalPeriods:t.length,firstPeriod:t[t.length-1],lastPeriod:t[0],metrics:{}},f=["reach","engagements","reactions","publications"];for(const C of f){const $=t.map(ee=>ee.metrics[C]).filter(ee=>ee!=null&&!isNaN(ee));if($.length>0){const ee=$.reduce((ce,Qe)=>ce+Qe,0)/$.length,se=Math.min(...$),ie=Math.max(...$),ke=t.find(ce=>ce.metrics[C]===ie),we=t.find(ce=>ce.metrics[C]===se);x.metrics[C]={average:Math.round(ee),min:se,max:ie,bestMonth:ke?{year:ke.year,month:ke.month,value:ie}:null,worstMonth:we?{year:we.year,month:we.month,value:se}:null}}}L(x);const p={};for(const C of U)if(t.length>=2){const $=((Y=t[t.length-1])==null?void 0:Y.metrics[C])||0,se=(((re=t[0])==null?void 0:re.metrics[C])||0)-$,ie=$>0?se/$*100:0;p[C]={change:se,percentChange:Math.round(ie*10)/10,trend:se>0?"up":se<0?"down":"stable"}}q(p)},H=t=>["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"][t-1],B=i.useMemo(()=>N.length?[...N].sort((t,c)=>{let x,f;P.key==="year_month"?(x=t.year*100+t.month,f=c.year*100+c.month):(x=t.metrics[P.key]||0,f=c.metrics[P.key]||0);const p=x-f;return P.direction==="asc"?p:-p}):[],[N,P]),m=i.useMemo(()=>{const t=(V-1)*T;return B.slice(t,t+T)},[B,V,T]),b=Math.ceil(B.length/T),s=t=>{J(c=>({key:t,direction:c.key===t&&c.direction==="asc"?"desc":"asc"}))},l=t=>P.key!==t?e.jsx(Je,{className:"h-4 w-4 ml-1 opacity-50"}):P.direction==="asc"?e.jsx(Ge,{className:"h-4 w-4 ml-1"}):e.jsx(Ke,{className:"h-4 w-4 ml-1"}),o=t=>{z(c=>c.includes(t)?c.filter(x=>x!==t):[...c,t])},u=()=>{const t=a.find(C=>C.pageId===h),c=["År","Månad","Period",...U.map(C=>{const $=be[C];return $?$.displayName:C})],x=B.map(C=>[C.year,C.month,`${H(C.month)} ${C.year}`,...U.map($=>C.metrics[$]||0)]),f=[c.join(","),...x.map(C=>C.join(","))].join(`
`),p=new Blob([f],{type:"text/csv;charset=utf-8;"}),S=document.createElement("a"),Y=URL.createObjectURL(p);S.setAttribute("href",Y);const re=(t==null?void 0:t.pageName.replace(/[^a-zA-Z0-9]/g,"_"))||"sida";S.setAttribute("download",`facebook_tidserie_${re}.csv`),S.style.visibility="hidden",document.body.appendChild(S),S.click(),document.body.removeChild(S)},d=t=>{switch(t){case"up":return e.jsx(ue,{className:"h-4 w-4 text-green-500"});case"down":return e.jsx(fs,{className:"h-4 w-4 text-red-500"});default:return e.jsx(gs,{className:"h-4 w-4 text-gray-500"})}};if(i.useEffect(()=>{X(1)},[T,h,U]),O)return e.jsx(A,{children:e.jsx(I,{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-b-2 border-facebook-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Laddar siddata..."})]})})});if(v)return e.jsxs(K,{variant:"destructive",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(W,{children:"Fel vid laddning av data"}),e.jsx(Z,{children:v})]});if(n.length===0)return e.jsxs(K,{children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(W,{children:"Ingen data tillgänglig"}),e.jsx(Z,{children:"Ladda upp Facebook CSV-filer för att visa sidanalys över tid."})]});if(a.length===0)return e.jsxs(K,{children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(W,{children:"Inga sidor hittades"}),e.jsx(Z,{children:"Kunde inte hitta några Facebook-sidor i den uppladdade datan."})]});const _=a.find(t=>t.pageId===h);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-facebook-500"}),"Sidanalys över tid"]})}),e.jsx(I,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Välj Facebook-sida"}),e.jsxs(ve,{value:h,onValueChange:j,children:[e.jsx(pe,{children:e.jsx(ye,{placeholder:"Välj sida att analysera"})}),e.jsx(je,{children:a.map(t=>e.jsx(Ne,{value:t.pageId,children:t.pageName},t.pageId))})]}),_&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",_.pageId]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Metrics att visa"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Ts.map(t=>{const c=U.includes(t.key);return e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:()=>o(t.key),className:"h-4 w-4 text-facebook-500 border-gray-300 rounded focus:ring-facebook-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t.label})]},t.key)})})]})]})})]}),g&&e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-5 w-5 text-facebook-500"}),"Prestanda-sammandrag för ",g.pageName]})}),e.jsxs(I,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-lg text-facebook-600",children:g.totalPeriods}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Månader med data"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Första månad"}),e.jsx("div",{className:"font-medium",children:g.firstPeriod?`${H(g.firstPeriod.month)} ${g.firstPeriod.year}`:"-"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Senaste månad"}),e.jsx("div",{className:"font-medium",children:g.lastPeriod?`${H(g.lastPeriod.month)} ${g.lastPeriod.year}`:"-"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Dataperiod"}),e.jsx("div",{className:"font-medium",children:g.totalPeriods>1?`${g.totalPeriods} månader`:"En månad"})]})]}),Object.keys(R).length>0&&e.jsxs("div",{className:"border rounded-lg p-4 bg-muted/30",children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Utvecklingstrend (första vs senaste månaden)"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:U.slice(0,3).map(t=>{const c=R[t],x=be[t];return!c||!x?null:e.jsxs("div",{className:"flex items-center justify-between p-3 rounded border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:x.displayName}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[c.change>0?"+":"",c.change.toLocaleString(),"(",c.percentChange>0?"+":"",c.percentChange,"%)"]})]}),d(c.trend)]},t)})})]})]})]}),e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-facebook-500"}),"Månadsutveckling (",B.length," månader)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",onClick:u,children:[e.jsx(Ye,{className:"mr-2 h-4 w-4"}),"CSV"]}),e.jsxs(M,{variant:"outline",onClick:()=>u(),children:[e.jsx(ze,{className:"mr-2 h-4 w-4"}),"Excel"]})]})]})}),e.jsxs(I,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ce,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(ge,{className:"cursor-pointer hover:bg-muted/50 min-w-[120px]",onClick:()=>s("year_month"),children:e.jsxs("div",{className:"flex items-center",children:["Period ",l("year_month")]})}),U.map(t=>{const c=be[t];return e.jsx(ge,{className:"cursor-pointer hover:bg-muted/50 text-right",onClick:()=>s(t),children:e.jsxs("div",{className:"flex items-center justify-end",children:[c?c.displayName:t,l(t)]})},t)})]})}),e.jsx(Ve,{children:m.map((t,c)=>e.jsxs(he,{children:[e.jsx(fe,{className:"font-medium",children:e.jsxs("div",{children:[e.jsxs("div",{children:[H(t.month)," ",t.year]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[t.year,"-",String(t.month).padStart(2,"0")]})]})}),U.map(x=>{const f=t.metrics[x]||0,p=be[x],S=g==null?void 0:g.metrics[x],Y=S&&f===S.max,re=S&&f===S.min&&S.min!==S.max;return e.jsxs(fe,{className:"text-right",children:[e.jsxs("div",{className:`font-mono ${Y?"text-green-600 font-bold":re?"text-red-600":""}`,children:[typeof f=="number"?f.toLocaleString():f,Y&&e.jsx("span",{className:"ml-1 text-xs",children:"🏆"}),re&&e.jsx("span",{className:"ml-1 text-xs",children:"📉"})]}),p&&p.category==="unique_persons"&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Unika"})]},x)})]},`${t.year}-${t.month}`))})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Visa"}),e.jsxs(ve,{value:T.toString(),onValueChange:t=>G(Number(t)),children:[e.jsx(pe,{className:"w-[140px]",children:e.jsx(ye,{})}),e.jsx(je,{children:Fs.map(t=>e.jsx(Ne,{value:t.value.toString(),children:t.label},t.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Visar ",(V-1)*T+1," till ",Math.min(V*T,B.length)," av ",B.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"outline",size:"sm",onClick:()=>X(t=>Math.max(1,t-1)),disabled:V===1,children:e.jsx(He,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:["Sida ",V," av ",b]}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>X(t=>Math.min(b,t+1)),disabled:V>=b,children:e.jsx(qe,{className:"h-4 w-4"})})]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-muted/30 rounded-lg",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"🏆 = Bästa värde för denna sida"}),e.jsx("span",{className:"mx-4",children:"📉 = Sämsta värde för denna sida"})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:"Gröna värden = bästa prestanda, röda värden = sämsta prestanda för vald tidsperiod"})]})})]})]})]})}const Es=[{value:10,label:"10 per sida"},{value:25,label:"25 per sida"},{value:50,label:"50 per sida"},{value:100,label:"100 per sida"}],Rs=[{key:"reach",label:"Räckvidd",canSum:!1},{key:"engagements",label:"Engagemang",canSum:!0},{key:"reactions",label:"Reaktioner",canSum:!0},{key:"publications",label:"Publiceringar",canSum:!0}],ne={reach:{displayName:"Räckvidd",canSumAcrossPages:!1,category:"unique_persons"},engagements:{displayName:"Engagemang",canSumAcrossPages:!0,category:"countable"},reactions:{displayName:"Reaktioner",canSumAcrossPages:!0,category:"countable"},publications:{displayName:"Publiceringar",canSumAcrossPages:!0,category:"countable"}};function _s({uploadedPeriods:n=[]}){const[a,r]=i.useState(null),[h,j]=i.useState([]),[N,w]=i.useState(null),[O,F]=i.useState(!1),[v,y]=i.useState(null),[g,L]=i.useState({key:"pageName",direction:"asc"}),[R,q]=i.useState(1),[P,J]=i.useState(25),[V,X]=i.useState(["reach","engagements","publications"]);i.useEffect(()=>{if(n.length>0&&!a){const s=n[0];r({year:s.year,month:s.month})}},[n,a]),i.useEffect(()=>{if(!a)return;(()=>{try{F(!0),y(null);const l=n.find(d=>d.year===a.year&&d.month===a.month);if(!l){y(`Ingen data hittades för ${G(a.month)} ${a.year}`),j([]),w(null);return}const o=l.data.map(d=>({page:{pageName:d.Page||d.page||"Okänd sida",pageId:d["Page ID"]||d.pageId||"unknown"},period:{year:a.year,month:a.month},metrics:{reach:T(d.Reach||d.reach),engagements:T(d.Engagements||d.engagements),reactions:T(d.Reactions||d.reactions),publications:T(d.Publications||d.publications)}}));j(o);const u=U(o,a.year,a.month);w(u)}catch(l){console.error("Error loading period data:",l),y(`Kunde inte ladda data för ${G(a.month)} ${a.year}`)}finally{F(!1)}})()},[a,n]);const T=s=>{if(s==null||s==="")return 0;const l=parseFloat(String(s).replace(/[,\s]/g,""));return isNaN(l)?0:l},G=s=>["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"][s-1],U=(s,l,o)=>{if(!s.length)return null;const u={period:{year:l,month:o},totalPages:s.length,metrics:{}},d=["reach","engagements","reactions","publications"];for(const _ of d){const t=s.map(x=>x.metrics[_]).filter(x=>x!=null&&!isNaN(x)&&x>=0);if(t.length===0){u.metrics[_]={total:0,average:0,min:0,max:0,validPages:0,type:ne[_].category};continue}if(!ne[_].canSumAcrossPages)u.metrics[_]={average:Math.round(t.reduce((x,f)=>x+f,0)/t.length),min:Math.min(...t),max:Math.max(...t),validPages:t.length,type:"unique_persons",note:"Genomsnitt över sidor - total reach kan inte beräknas"};else{const x=t.reduce((f,p)=>f+p,0);u.metrics[_]={total:x,average:Math.round(x/t.length),min:Math.min(...t),max:Math.max(...t),validPages:t.length,type:"countable"}}}return u},z=i.useMemo(()=>h.length?[...h].sort((s,l)=>{let o,u;if(g.key==="pageName"?(o=s.page.pageName,u=l.page.pageName):(o=s.metrics[g.key]||0,u=l.metrics[g.key]||0),typeof o=="string"){const _=o.localeCompare(u);return g.direction==="asc"?_:-_}const d=o-u;return g.direction==="asc"?d:-d}):[],[h,g]),Q=i.useMemo(()=>{const s=(R-1)*P;return z.slice(s,s+P)},[z,R,P]),te=Math.ceil(z.length/P),H=s=>{L(l=>({key:s,direction:l.key===s&&l.direction==="asc"?"desc":"asc"}))},B=s=>g.key!==s?e.jsx(Je,{className:"h-4 w-4 ml-1 opacity-50"}):g.direction==="asc"?e.jsx(Ge,{className:"h-4 w-4 ml-1"}):e.jsx(Ke,{className:"h-4 w-4 ml-1"}),m=s=>{X(l=>l.includes(s)?l.filter(o=>o!==s):[...l,s])},b=()=>{const s=["Sidnamn","Sido-ID",...V.map(c=>{const x=ne[c];return x?x.displayName:c})],l=z.map(c=>[c.page.pageName,c.page.pageId,...V.map(x=>c.metrics[x]||0)]),o=[s.join(","),...l.map(c=>c.join(","))].join(`
`),u=new Blob([o],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),_=URL.createObjectURL(u);d.setAttribute("href",_);const t=a?`${G(a.month)}_${a.year}`:"månadsanalys";d.setAttribute("download",`facebook_månadsanalys_${t}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)};return i.useEffect(()=>{q(1)},[P,a,V]),O?e.jsx(A,{children:e.jsx(I,{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-b-2 border-facebook-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Laddar månadsdata..."})]})})}):v?e.jsxs(K,{variant:"destructive",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(W,{children:"Fel vid laddning av data"}),e.jsx(Z,{children:v})]}):n.length===0?e.jsxs(K,{children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(W,{children:"Ingen data tillgänglig"}),e.jsx(Z,{children:"Ladda upp Facebook CSV-filer för att visa månadsanalys."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-facebook-500"}),"Månadsanalys"]})}),e.jsxs(I,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Välj månad"}),e.jsxs(ve,{value:a?`${a.year}-${a.month}`:"",onValueChange:s=>{const[l,o]=s.split("-").map(Number);r({year:l,month:o})},children:[e.jsx(pe,{children:e.jsx(ye,{placeholder:"Välj månad att analysera"})}),e.jsx(je,{children:n.map(s=>e.jsxs(Ne,{value:`${s.year}-${s.month}`,children:[G(s.month)," ",s.year]},`${s.year}-${s.month}`))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Metrics att visa"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Rs.map(s=>{const l=V.includes(s.key);return e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:()=>m(s.key),className:"h-4 w-4 text-facebook-500 border-gray-300 rounded focus:ring-facebook-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.label})]},s.key)})})]})]}),N&&e.jsxs("div",{className:"border rounded-lg p-4 bg-muted/30",children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Sammandrag för ",a?`${G(a.month)} ${a.year}`:""]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-lg text-facebook-600",children:N.totalPages}),e.jsx("div",{className:"text-muted-foreground",children:"Facebook-sidor"})]}),V.slice(0,3).map(s=>{const l=N.metrics[s],o=ne[s];if(!l||!o)return null;const u=o.canSumAcrossPages?l.total:l.average,d=o.canSumAcrossPages?"Totalt":"Genomsnitt";return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-lg text-facebook-600",children:u?u.toLocaleString():0}),e.jsxs("div",{className:"text-muted-foreground",children:[d," ",o.displayName.toLowerCase()]})]},s)})]})]})]})]}),e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-5 w-5 text-facebook-500"}),"Facebook-sidor (",z.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{variant:"outline",onClick:b,children:[e.jsx(Ye,{className:"mr-2 h-4 w-4"}),"CSV"]}),e.jsxs(M,{variant:"outline",onClick:()=>b(),children:[e.jsx(ze,{className:"mr-2 h-4 w-4"}),"Excel"]})]})]})}),e.jsxs(I,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ce,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(ge,{className:"cursor-pointer hover:bg-muted/50 min-w-[200px]",onClick:()=>H("pageName"),children:e.jsxs("div",{className:"flex items-center",children:["Sidnamn ",B("pageName")]})}),V.map(s=>{const l=ne[s];return e.jsx(ge,{className:"cursor-pointer hover:bg-muted/50 text-right",onClick:()=>H(s),children:e.jsxs("div",{className:"flex items-center justify-end",children:[l?l.displayName:s,B(s)]})},s)})]})}),e.jsx(Ve,{children:Q.map((s,l)=>e.jsxs(he,{children:[e.jsx(fe,{className:"font-medium",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate",title:s.page.pageName,children:s.page.pageName}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["ID: ",s.page.pageId]})]})}),V.map(o=>{const u=s.metrics[o]||0,d=ne[o];return e.jsxs(fe,{className:"text-right",children:[e.jsx("div",{className:"font-mono",children:typeof u=="number"?u.toLocaleString():u}),d&&d.category==="unique_persons"&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Unika personer"})]},o)})]},s.page.pageId||l))})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Visa"}),e.jsxs(ve,{value:P.toString(),onValueChange:s=>J(Number(s)),children:[e.jsx(pe,{className:"w-[140px]",children:e.jsx(ye,{})}),e.jsx(je,{children:Es.map(s=>e.jsx(Ne,{value:s.value.toString(),children:s.label},s.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Visar ",(R-1)*P+1," till ",Math.min(R*P,z.length)," av ",z.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"outline",size:"sm",onClick:()=>q(s=>Math.max(1,s-1)),disabled:R===1,children:e.jsx(He,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:["Sida ",R," av ",te]}),e.jsx(M,{variant:"outline",size:"sm",onClick:()=>q(s=>Math.min(te,s+1)),disabled:R>=te,children:e.jsx(qe,{className:"h-4 w-4"})})]})]})]}),V.some(s=>{var l;return((l=ne[s])==null?void 0:l.category)==="unique_persons"})&&e.jsxs(K,{className:"mt-4 bg-amber-50 border-amber-200",children:[e.jsx(ae,{className:"h-4 w-4 text-amber-600"}),e.jsx(W,{className:"text-amber-800",children:"Viktigt om Räckvidd"}),e.jsx(Z,{className:"text-amber-700",children:"Räckvidd representerar unika personer per månad och kan ALDRIG summeras över månader eller sidor. Värdena i tabellen visar data för den valda månaden."})]})]})]})]})}function $s(){const[n,a]=i.useState(!1),[r,h]=i.useState(!1),[j,N]=i.useState("upload"),[w,O]=i.useState([]),F=y=>{console.log("Data uploaded successfully:",y),O(y),a(!0),h(!1),N("monthly")},v=()=>{h(!1)};return r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b border-border",children:e.jsx("div",{className:"container py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"facebook-brand flex items-center gap-3",children:[e.jsx(le,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Facebook API data analyser"})]}),e.jsxs(M,{variant:"outline",onClick:v,children:[e.jsx(js,{className:"mr-2 h-4 w-4"}),"Tillbaka"]})]})})}),e.jsx("main",{className:"container py-6",children:e.jsx(Ms,{onDataUploaded:F,onCancel:v})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b border-border",children:e.jsx("div",{className:"container py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"facebook-brand flex items-center gap-3",children:[e.jsx(le,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Facebook API data analyser"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Tidserie-baserad analys av månadsstatistik"})]})})}),e.jsx("main",{className:"container py-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(K,{variant:"info",className:"bg-facebook-50 border-facebook-200",children:[e.jsx(Ns,{className:"h-4 w-4 text-facebook-600"}),e.jsx(W,{className:"text-facebook-800",children:"Välkommen till Facebook API data analyser"}),e.jsxs(Z,{className:"text-facebook-700",children:[e.jsxs("p",{className:"mb-2",children:["Detta verktyg analyserar månadsdata från Facebook API i CSV-format. Ladda upp filer som följer namnkonventionen ",e.jsx("code",{className:"bg-white px-1 rounded",children:"FB_YYYY_MM.csv"}),"(t.ex. FB_2025_08.csv för Augusti 2025)."]}),e.jsx("p",{className:"font-medium",children:"VIKTIGT: Reach och Engaged Users kan aldrig summeras över månader (unika personer per månad)."})]})]}),n?e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5 text-facebook-500"}),"Uppladdad data"]})}),e.jsxs(I,{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-facebook-600",children:w.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Månader"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-facebook-600",children:w.reduce((y,g)=>y+(g.pageCount||0),0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Totalt sidposter"})]}),e.jsx("div",{className:"text-center",children:e.jsxs(M,{variant:"outline",onClick:()=>h(!0),className:"w-full",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Ladda mer data"]})})]}),w.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Uppladdade perioder:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map((y,g)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-facebook-50 text-facebook-700 border border-facebook-200",children:[y.displayName," (",y.pageCount," sidor)"]},g))})]})]})]}),e.jsxs(Ps,{value:j,onValueChange:N,children:[e.jsxs(Xe,{className:"grid w-full grid-cols-4",children:[e.jsxs(oe,{value:"upload",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Ladda data"]}),e.jsxs(oe,{value:"monthly",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Månadsanalys"]}),e.jsxs(oe,{value:"pages",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Sidanalys"]}),e.jsxs(oe,{value:"trends",children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Trender"]})]}),e.jsx(me,{value:"upload",className:"mt-6",children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsx(E,{children:"Hantera CSV-data"})}),e.jsxs(I,{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:"Hantera dina uppladdade CSV-filer och ladda upp ytterligare månadsdata."}),e.jsxs(M,{onClick:()=>h(!0),children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Ladda upp mer data"]})]})]})}),e.jsx(me,{value:"monthly",className:"mt-6",children:e.jsx(_s,{uploadedPeriods:w})}),e.jsx(me,{value:"pages",className:"mt-6",children:e.jsx(Ds,{uploadedPeriods:w})}),e.jsx(me,{value:"trends",className:"mt-6",children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsx(E,{children:"Trendanalys"})}),e.jsxs(I,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"TrendAnalysisView implementeras i FAS 7"}),w.length>1&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Trendanalys tillgänglig för ",w.length," månader"]})]})]})})]})]}):e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(A,{className:"timeseries-card",children:[e.jsxs(D,{className:"text-center",children:[e.jsx(de,{className:"h-16 w-16 mx-auto mb-4 text-facebook-500"}),e.jsx(E,{className:"text-2xl",children:"Börja med att ladda upp CSV-filer"}),e.jsx("p",{className:"text-muted-foreground",children:"Ladda upp en eller flera månads-CSV:er för att börja analysera Facebook-data över tid"})]}),e.jsx(I,{className:"text-center",children:e.jsxs(M,{variant:"facebook",size:"lg",onClick:()=>h(!0),children:[e.jsx(de,{className:"mr-2 h-5 w-5"}),"Ladda upp CSV-filer"]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(A,{className:"opacity-50",children:[e.jsxs(D,{children:[e.jsx(xe,{className:"h-8 w-8 text-facebook-500 mb-2"}),e.jsx(E,{className:"text-lg",children:"Månadsanalys"})]}),e.jsx(I,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analysera prestanda för specifika månader och jämför mellan perioder"})})]}),e.jsxs(A,{className:"opacity-50",children:[e.jsxs(D,{children:[e.jsx(ue,{className:"h-8 w-8 text-facebook-500 mb-2"}),e.jsx(E,{className:"text-lg",children:"Trendanalys"})]}),e.jsx(I,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upptäck trender och utvecklingsmönster över tid för alla Facebook-sidor"})})]}),e.jsxs(A,{className:"opacity-50",children:[e.jsxs(D,{children:[e.jsx(le,{className:"h-8 w-8 text-facebook-500 mb-2"}),e.jsx(E,{className:"text-lg",children:"Sidanalys"})]}),e.jsx(I,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Djupdyk i specifika Facebook-sidor och deras utveckling över månader"})})]})]})]})]})}),e.jsx("footer",{className:"border-t border-border mt-12",children:e.jsxs("div",{className:"container py-4 text-center text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Facebook API data analyser © ",new Date().getFullYear()]}),e.jsxs("p",{className:"mt-1",children:["Tidserie-baserad analys av månadsstatistik |",e.jsx("span",{className:"text-facebook-500 font-medium",children:" Utvecklad för projektfas 1-8"})]})]})})]})}Se.createRoot(document.getElementById("root")).render(e.jsx(vs.StrictMode,{children:e.jsx($s,{})}));
//# sourceMappingURL=index-BzzxjXZU.js.map
