import{j as e,S as ts,L as Oe,T as $e,C as Be,R as ns,U as Te,A as ie,F as rs,a as he,b as Re,c as ls,X as is,B as re,d as Ue,I as cs,e as ds,P as os,f as ze,V as ms,g as Ye,h as Ke,i as xs,k as us,l as hs,m as He,n as gs,o as fs,p as Ce,q as Pe,r as ps,s as Je,t as qe,u as Ge,v as Ze,w as We,x as Xe,y as js,z as Ns,D as me}from"./ui-Dpej3i55.js";import{b as bs,r as o,R as vs}from"./vendor-DB9HQzDI.js";import{t as ys,c as Qe,P as ks}from"./utils-GaJ1HoMq.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))d(l);new MutationObserver(l=>{for(const x of l)if(x.type==="childList")for(const y of x.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&d(y)}).observe(document,{childList:!0,subtree:!0});function a(l){const x={};return l.integrity&&(x.integrity=l.integrity),l.referrerPolicy&&(x.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?x.credentials="include":l.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function d(l){if(l.ep)return;l.ep=!0;const x=a(l);fetch(l.href,x)}})();var Ae={},Fe=bs;Ae.createRoot=Fe.createRoot,Ae.hydrateRoot=Fe.hydrateRoot;function S(...r){return ys(Qe(r))}const D=o.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:S("rounded-lg border bg-card text-card-foreground shadow-sm",r),...t}));D.displayName="Card";const E=o.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:S("flex flex-col space-y-1.5 p-6",r),...t}));E.displayName="CardHeader";const _=o.forwardRef(({className:r,...t},a)=>e.jsx("h3",{ref:a,className:S("text-2xl font-semibold leading-none tracking-tight",r),...t}));_.displayName="CardTitle";const ws=o.forwardRef(({className:r,...t},a)=>e.jsx("p",{ref:a,className:S("text-sm text-muted-foreground",r),...t}));ws.displayName="CardDescription";const L=o.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:S("p-6 pt-0",r),...t}));L.displayName="CardContent";const Ss=o.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:S("flex items-center p-6 pt-0",r),...t}));Ss.displayName="CardFooter";const De=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Ee=Qe,es=(r,t)=>a=>{var d;if((t==null?void 0:t.variants)==null)return Ee(r,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:l,defaultVariants:x}=t,y=Object.keys(l).map(k=>{const w=a==null?void 0:a[k],p=x==null?void 0:x[k];if(w===null)return null;const O=De(w)||De(p);return l[k][O]}),$=a&&Object.entries(a).reduce((k,w)=>{let[p,O]=w;return O===void 0||(k[p]=O),k},{}),M=t==null||(d=t.compoundVariants)===null||d===void 0?void 0:d.reduce((k,w)=>{let{class:p,className:O,...R}=w;return Object.entries(R).every(X=>{let[C,Q]=X;return Array.isArray(Q)?Q.includes({...x,...$}[C]):{...x,...$}[C]===Q})?[...k,p,O]:k},[]);return Ee(r,y,M,a==null?void 0:a.class,a==null?void 0:a.className)},Cs=es("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary",facebook:"bg-facebook-500 text-white hover:bg-facebook-600"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),V=o.forwardRef(({className:r,variant:t,size:a,asChild:d=!1,...l},x)=>{const y=d?ts:"button";return e.jsx(y,{className:S(Cs({variant:t,size:a,className:r})),ref:x,...l})});V.displayName="Button";const Ps=ns,ss=o.forwardRef(({className:r,...t},a)=>e.jsx(Oe,{ref:a,className:S("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...t}));ss.displayName=Oe.displayName;const xe=o.forwardRef(({className:r,...t},a)=>e.jsx($e,{ref:a,className:S("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...t}));xe.displayName=$e.displayName;const ue=o.forwardRef(({className:r,...t},a)=>e.jsx(Be,{ref:a,className:S("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...t}));ue.displayName=Be.displayName;const As=es("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",success:"border-green-500/50 text-green-600 dark:text-green-400 [&>svg]:text-green-600",info:"border-facebook-300/50 text-facebook-600 dark:text-facebook-400 [&>svg]:text-facebook-600"}},defaultVariants:{variant:"default"}}),G=o.forwardRef(({className:r,variant:t,...a},d)=>e.jsx("div",{ref:d,role:"alert",className:S(As({variant:t}),r),...a}));G.displayName="Alert";const Z=o.forwardRef(({className:r,...t},a)=>e.jsx("h5",{ref:a,className:S("mb-1 font-medium leading-none tracking-tight",r),...t}));Z.displayName="AlertTitle";const W=o.forwardRef(({className:r,...t},a)=>e.jsx("div",{ref:a,className:S("text-sm [&_p]:leading-relaxed",r),...t}));W.displayName="AlertDescription";const _e=["Page","Page ID","Reach","Engaged Users","Engagements","Reactions","Publications","Status","Comment"];function Vs({onDataUploaded:r,onCancel:t}){const[a,d]=o.useState([]),[l,x]=o.useState(!1),[y,$]=o.useState(!1),[M,k]=o.useState([]),[w,p]=o.useState({}),O=o.useRef(null),R=h=>{const b=/^FB_(\d{4})_(\d{2})\.csv$/,j=h.match(b);if(!j)return{isValid:!1,error:"Felaktigt filnamnsformat. Förväntat: FB_YYYY_MM.csv (t.ex. FB_2025_08.csv)"};const s=parseInt(j[1]),i=parseInt(j[2]);return i<1||i>12?{isValid:!1,error:"Ogiltig månad. Måste vara mellan 01-12."}:s<2020||s>2030?{isValid:!1,error:"Ogiltigt år. Måste vara mellan 2020-2030."}:{isValid:!0,year:s,month:i,displayName:`${X(i)} ${s}`}},X=h=>["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"][h-1],C=(h,b)=>new Promise(j=>{ks.parse(h,{header:!0,skipEmptyLines:!0,complete:s=>{if(s.errors.length>0){j({isValid:!1,error:`CSV-parsningsfel: ${s.errors[0].message}`,data:null});return}const i=s.meta.fields||[],m=_e.filter(v=>!i.includes(v));if(m.length>0){j({isValid:!1,error:`Saknade kolumner: ${m.join(", ")}`,data:null});return}if(s.data.length===0){j({isValid:!1,error:"CSV-filen innehåller ingen data",data:null});return}j({isValid:!0,data:s.data,pageCount:s.data.length,error:null})}})}),Q=h=>{h.preventDefault(),h.stopPropagation(),$(!1);const b=Array.from(h.dataTransfer.files),j=b.filter(s=>s.name.toLowerCase().endsWith(".csv"));j.length!==b.length&&k(s=>[...s,"Endast CSV-filer är tillåtna"]),j.length>0&&ae(j)},A=h=>{const b=Array.from(h.target.files);ae(b)},ae=h=>{const b=h.map(m=>{const v=R(m.name);return{file:m,id:Math.random().toString(36),name:m.name,size:m.size,validation:v,status:v.isValid?"pending":"error"}}),j=a.map(m=>m.name),s=b.filter(m=>j.includes(m.name));s.length>0&&k(m=>[...m,`Följande filer är redan valda: ${s.map(v=>v.name).join(", ")}`]);const i=b.filter(m=>!j.includes(m.name));d(m=>[...m,...i])},F=h=>{d(b=>b.filter(j=>j.id!==h))},B=async()=>{x(!0),k([]),p({});const h=a.filter(j=>j.validation.isValid),b=[];for(const j of h){p(s=>({...s,[j.id]:"processing"}));try{const s=await U(j.file),i=await C(s,j.name);if(!i.isValid){p(v=>({...v,[j.id]:"error"})),k(v=>[...v,`${j.name}: ${i.error}`]);continue}const m={...j.validation,data:i.data,pageCount:i.pageCount,filename:j.name};b.push(m),p(v=>({...v,[j.id]:"success"})),await new Promise(v=>setTimeout(v,500))}catch(s){p(i=>({...i,[j.id]:"error"})),k(i=>[...i,`${j.name}: ${s.message}`])}}x(!1),b.length>0&&r(b)},U=h=>new Promise((b,j)=>{const s=new FileReader;s.onload=i=>b(i.target.result),s.onerror=()=>j(new Error("Kunde inte läsa fil")),s.readAsText(h)}),K=h=>{h.preventDefault(),h.stopPropagation(),$(!0)},H=h=>{h.preventDefault(),h.stopPropagation(),$(!1)},le=()=>{k([])},z=a.filter(h=>h.validation.isValid).length,Y=z>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsxs(E,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-facebook-500"}),"Ladda upp Facebook CSV-filer"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Släpp dina FB_YYYY_MM.csv filer här eller klicka för att välja filer"})]}),e.jsx(L,{children:e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer ${y?"border-facebook-400 bg-facebook-50":"border-gray-300 hover:border-facebook-400 hover:bg-facebook-50"}`,onDrop:Q,onDragOver:K,onDragLeave:H,onClick:()=>{var h;return(h=O.current)==null?void 0:h.click()},children:[e.jsx("input",{type:"file",ref:O,onChange:A,multiple:!0,accept:".csv",className:"hidden"}),e.jsx(Te,{className:"h-12 w-12 mx-auto mb-4 text-facebook-400"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:y?"Släpp filerna här":"Ladda upp CSV-filer"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Släpp dina FB_YYYY_MM.csv filer här eller klicka för att välja"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Format:"})," FB_YYYY_MM.csv (t.ex. FB_2025_08.csv)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Kolumner:"})," ",_e.join(", ")]})]})]})})]}),M.length>0&&e.jsxs(G,{variant:"destructive",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(Z,{children:"Valideringsfel"}),e.jsxs(W,{children:[e.jsx("ul",{className:"list-disc list-inside space-y-1",children:M.map((h,b)=>e.jsx("li",{children:h},b))}),e.jsx(V,{variant:"outline",size:"sm",onClick:le,className:"mt-2",children:"Rensa fel"})]})]}),a.length>0&&e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs(_,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Valda filer (",a.length,")"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[z," giltiga filer"]})]})}),e.jsx(L,{children:e.jsx("div",{className:"space-y-2",children:a.map(h=>{const b=w[h.id]||h.status;return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${h.validation.isValid?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:h.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:h.validation.isValid?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"h-3 w-3"}),h.validation.displayName]}):e.jsx("span",{className:"text-red-600",children:h.validation.error})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[b==="processing"&&e.jsx(Re,{className:"h-4 w-4 animate-spin text-blue-500"}),b==="success"&&e.jsx(ls,{className:"h-4 w-4 text-green-500"}),b==="error"&&e.jsx(ie,{className:"h-4 w-4 text-red-500"}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>F(h.id),disabled:l,children:e.jsx(is,{className:"h-4 w-4"})})]})]},h.id)})})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(V,{variant:"outline",onClick:t,disabled:l,children:"Avbryt"}),e.jsxs("div",{className:"flex gap-2",children:[a.length>0&&e.jsx(V,{variant:"outline",onClick:()=>d([]),disabled:l,children:"Rensa alla"}),e.jsx(V,{onClick:B,disabled:!Y||l,className:"min-w-[120px]",children:l?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"mr-2 h-4 w-4 animate-spin"}),"Bearbetar..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Analysera data (",z,")"]})})]})]})]})}const Ve=o.forwardRef(({className:r,...t},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:S("w-full caption-bottom text-sm",r),...t})}));Ve.displayName="Table";const Me=o.forwardRef(({className:r,...t},a)=>e.jsx("thead",{ref:a,className:S("[&_tr]:border-b",r),...t}));Me.displayName="TableHeader";const Ie=o.forwardRef(({className:r,...t},a)=>e.jsx("tbody",{ref:a,className:S("[&_tr:last-child]:border-0",r),...t}));Ie.displayName="TableBody";const ge=o.forwardRef(({className:r,...t},a)=>e.jsx("tr",{ref:a,className:S("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...t}));ge.displayName="TableRow";const fe=o.forwardRef(({className:r,...t},a)=>e.jsx("th",{ref:a,className:S("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...t}));fe.displayName="TableHead";const pe=o.forwardRef(({className:r,...t},a)=>e.jsx("td",{ref:a,className:S("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...t}));pe.displayName="TableCell";const ve=gs,ye=fs,je=o.forwardRef(({className:r,children:t,...a},d)=>e.jsxs(Ue,{ref:d,className:S("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...a,children:[t,e.jsx(cs,{asChild:!0,children:e.jsx(ds,{className:"h-4 w-4 opacity-50"})})]}));je.displayName=Ue.displayName;const Ne=o.forwardRef(({className:r,children:t,position:a="popper",...d},l)=>e.jsx(os,{children:e.jsx(ze,{ref:l,className:S("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:a,...d,children:e.jsx(ms,{className:S("p-1 max-h-[300px] overflow-y-auto",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));Ne.displayName=ze.displayName;const Ms=o.forwardRef(({className:r,...t},a)=>e.jsx(Ye,{ref:a,className:S("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...t}));Ms.displayName=Ye.displayName;const be=o.forwardRef(({className:r,children:t,...a},d)=>e.jsxs(Ke,{ref:d,className:S("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(xs,{children:e.jsx(us,{className:"h-4 w-4"})})}),e.jsx(hs,{children:t})]}));be.displayName=Ke.displayName;const Is=o.forwardRef(({className:r,...t},a)=>e.jsx(He,{ref:a,className:S("-mx-1 my-1 h-px bg-muted",r),...t}));Is.displayName=He.displayName;const J={P1:"#0066cc",P2:"#ff6600",P3:"#00cc66",P4:"#cc33cc",EKOT:"#005eb8",RADIOSPORTEN:"#1c5c35",SR:"#000000",default:"#000000"},Le=({pageName:r})=>{const t=r||"Okänd";let a=J.default,d="";const l=t.toLowerCase();l.includes("ekot")||l.includes("radio sweden")?(a=J.EKOT,d="E"):l.includes("radiosporten")||l.includes("radio sporten")?(a=J.RADIOSPORTEN,d="RS"):l.includes("p1")?(a=J.P1,d="P1"):l.includes("p2")?(a=J.P2,d="P2"):l.includes("p3")?(a=J.P3,d="P3"):l.includes("p4")?(a=J.P4,d="P4"):l.includes("sveriges radio")&&!l.includes("p1")&&!l.includes("p2")&&!l.includes("p3")&&!l.includes("p4")?(a=J.SR,d="SR"):d=t.charAt(0).toUpperCase();const y=a===J.P2||a===J.P3?"text-black":"text-white";return e.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-sm flex items-center justify-center text-xs font-bold ${y}`,style:{backgroundColor:a},title:r,children:d})},Ts=[{value:6,label:"6 per sida"},{value:12,label:"12 per sida"},{value:24,label:"24 per sida"}],Rs=[{key:"reach",label:"Räckvidd",canSum:!1},{key:"engagements",label:"Engagemang",canSum:!0},{key:"reactions",label:"Reaktioner",canSum:!0},{key:"publications",label:"Publiceringar",canSum:!0},{key:"status",label:"Status",canSum:!0},{key:"comment",label:"Kommentarer",canSum:!0}],Se={reach:{displayName:"Räckvidd",canSumAcrossPages:!1,category:"unique_persons"},engagements:{displayName:"Engagemang",canSumAcrossPages:!0,category:"countable"},reactions:{displayName:"Reaktioner",canSumAcrossPages:!0,category:"countable"},publications:{displayName:"Publiceringar",canSumAcrossPages:!0,category:"countable"},status:{displayName:"Status",canSumAcrossPages:!0,category:"countable"},comment:{displayName:"Kommentarer",canSumAcrossPages:!0,category:"countable"}};function Fs({uploadedPeriods:r=[]}){const[t,a]=o.useState([]),[d,l]=o.useState(""),[x,y]=o.useState([]),[$,M]=o.useState(!0),[k,w]=o.useState(null),[p,O]=o.useState(null),[R,X]=o.useState({}),[C,Q]=o.useState({key:"year_month",direction:"desc"}),[A,ae]=o.useState(1),[F,B]=o.useState(12),[U,K]=o.useState(["reach","engagements","publications"]);o.useEffect(()=>{(()=>{try{if(M(!0),r.length===0){a([]),M(!1);return}const c=new Map;r.forEach(u=>{u.data&&Array.isArray(u.data)&&u.data.forEach(f=>{const P=f.Page||f.page||"Okänd sida",ee=f["Page ID"]||f.pageId||`page_${P.replace(/\s+/g,"_")}`;c.has(ee)||c.set(ee,{pageId:ee,pageName:P})})});const g=Array.from(c.values()).sort((u,f)=>u.pageName.localeCompare(f.pageName));a(g),g.length>0&&l(g[0].pageId)}catch(c){console.error("Error loading pages:",c),w("Kunde inte ladda tillgängliga Facebook-sidor")}finally{M(!1)}})()},[r]),o.useEffect(()=>{if(!d||r.length===0)return;(()=>{try{M(!0),w(null);const c=[];if(r.forEach(u=>{if(u.data&&Array.isArray(u.data)){const f=u.data.find(P=>(P["Page ID"]||P.pageId||`page_${(P.Page||P.page||"").replace(/\s+/g,"_")}`)===d);f&&c.push({year:u.year,month:u.month,pageName:f.Page||f.page||"Okänd sida",pageId:d,metrics:{reach:H(f.Reach||f.reach),engagements:H(f.Engagements||f.engagements),reactions:H(f.Reactions||f.reactions),publications:H(f.Publications||f.publications),status:H(f.Status||f.status),comment:H(f.Comment||f.comment)}})}}),c.length===0){const u=t.find(f=>f.pageId===d);w(`Ingen tidserie-data hittades för ${(u==null?void 0:u.pageName)||"vald sida"}`);return}const g=c.sort((u,f)=>u.year!==f.year?f.year-u.year:f.month-u.month);y(g),le(g)}catch(c){console.error("Error loading page timeseries:",c);const g=t.find(u=>u.pageId===d);w(`Kunde inte ladda data för ${(g==null?void 0:g.pageName)||"vald sida"}`)}finally{M(!1)}})()},[d,r,t]);const H=n=>{if(n==null||n==="")return 0;const c=parseFloat(String(n).replace(/[,\s]/g,""));return isNaN(c)?0:c},le=n=>{var P,ee,I;if(n.length===0)return;const c=t.find(T=>T.pageId===d),g={pageName:(c==null?void 0:c.pageName)||((P=n[0])==null?void 0:P.pageName)||"Okänd sida",totalPeriods:n.length,firstPeriod:n[n.length-1],lastPeriod:n[0],metrics:{}},u=["reach","engagements","reactions","publications"];for(const T of u){const se=n.map(te=>te.metrics[T]).filter(te=>te!=null&&!isNaN(te));if(se.length>0){const te=se.reduce((oe,as)=>oe+as,0)/se.length,ne=Math.min(...se),de=Math.max(...se),ke=n.find(oe=>oe.metrics[T]===de),we=n.find(oe=>oe.metrics[T]===ne);g.metrics[T]={average:Math.round(te),min:ne,max:de,bestMonth:ke?{year:ke.year,month:ke.month,value:de}:null,worstMonth:we?{year:we.year,month:we.month,value:ne}:null}}}O(g);const f={};for(const T of U)if(n.length>=2){const se=((ee=n[n.length-1])==null?void 0:ee.metrics[T])||0,ne=(((I=n[0])==null?void 0:I.metrics[T])||0)-se,de=se>0?ne/se*100:0;f[T]={change:ne,percentChange:Math.round(de*10)/10,trend:ne>0?"up":ne<0?"down":"stable"}}X(f)},z=n=>["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"][n-1],Y=o.useMemo(()=>x.length?[...x].sort((n,c)=>{let g,u;C.key==="year_month"?(g=n.year*100+n.month,u=c.year*100+c.month):(g=n.metrics[C.key]||0,u=c.metrics[C.key]||0);const f=g-u;return C.direction==="asc"?f:-f}):[],[x,C]),h=o.useMemo(()=>{const n=(A-1)*F;return Y.slice(n,n+F)},[Y,A,F]),b=Math.ceil(Y.length/F),j=n=>{Q(c=>({key:n,direction:c.key===n&&c.direction==="asc"?"desc":"asc"}))},s=n=>C.key!==n?e.jsx(Ze,{className:"h-4 w-4 ml-1 opacity-50"}):C.direction==="asc"?e.jsx(We,{className:"h-4 w-4 ml-1"}):e.jsx(Xe,{className:"h-4 w-4 ml-1"}),i=n=>{K(c=>c.includes(n)?c.filter(g=>g!==n):[...c,n])},m=()=>{const n=t.find(I=>I.pageId===d),c=["År","Månad","Period",...U.map(I=>{const T=Se[I];return T?T.displayName:I})],g=Y.map(I=>[I.year,I.month,`${z(I.month)} ${I.year}`,...U.map(T=>I.metrics[T]||0)]),u=[c.join(","),...g.map(I=>I.join(","))].join(`
`),f=new Blob([u],{type:"text/csv;charset=utf-8;"}),P=document.createElement("a"),ee=URL.createObjectURL(f);P.setAttribute("href",ee),P.setAttribute("download",`${n==null?void 0:n.pageName.replace(/[^a-zA-Z0-9]/g,"_")}_tidsserie.csv`),P.style.visibility="hidden",document.body.appendChild(P),P.click(),document.body.removeChild(P)},v=n=>n==null||isNaN(n)?"-":new Intl.NumberFormat("sv-SE").format(n);if($)return e.jsxs(G,{children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx(Z,{children:"Laddar data"}),e.jsx(W,{children:"Analyserar tidserie-data för Facebook-sidor..."})]});if(k)return e.jsxs(G,{variant:"destructive",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(Z,{children:"Fel"}),e.jsx(W,{children:k})]});if(t.length===0)return e.jsxs(G,{children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(Z,{children:"Inga sidor hittades"}),e.jsx(W,{children:"Kunde inte hitta några Facebook-sidor i den uppladdade datan."})]});const N=t.find(n=>n.pageId===d);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-facebook-500"}),"Sidanalys över tid"]})}),e.jsxs(L,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Välj Facebook-sida"}),e.jsxs(ve,{value:d,onValueChange:l,children:[e.jsx(je,{children:e.jsx(ye,{placeholder:"Välj sida att analysera"})}),e.jsx(Ne,{children:t.map(n=>e.jsx(be,{value:n.pageId,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{pageName:n.pageName}),e.jsx("span",{children:n.pageName})]})},n.pageId))})]}),N&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",N.pageId]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Metrics att visa"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Rs.map(n=>{const c=U.includes(n.key);return e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:()=>i(n.key),className:"h-4 w-4 text-facebook-500 border-gray-300 rounded focus:ring-facebook-500"}),e.jsx("span",{className:"text-sm font-medium",children:n.label}),!n.canSum&&e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"*"})]},n.key)})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"* = Kan inte summeras över månader (unika personer)"})]})]}),p&&e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6 p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-facebook-600 flex items-center justify-center gap-2",children:[e.jsx(Le,{pageName:p.pageName}),p.totalPeriods]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Månader data"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold",children:[z(p.firstPeriod.month)," ",p.firstPeriod.year]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Första månad"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold",children:[z(p.lastPeriod.month)," ",p.lastPeriod.year]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Senaste månad"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-facebook-600",children:(N==null?void 0:N.pageName)||"Okänd sida"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Vald sida"})]})]}),Object.keys(R).length>0&&e.jsx("div",{className:"grid md:grid-cols-3 gap-4 mb-6",children:U.slice(0,3).map(n=>{const c=R[n],g=Se[n];return!c||!g?null:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg",children:[c.trend==="up"&&e.jsx(Pe,{className:"h-5 w-5 text-green-600"}),c.trend==="down"&&e.jsx(ps,{className:"h-5 w-5 text-red-600"}),c.trend==="stable"&&e.jsx(Ce,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:g.displayName}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[c.percentChange>0?"+":"",c.percentChange,"% sedan första månad"]})]})]},n)})})]})]}),e.jsxs(D,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between",children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),"Månadsvis utveckling - ",(N==null?void 0:N.pageName)||"Okänd sida"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(V,{onClick:m,variant:"outline",size:"sm",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"CSV"]})})]}),e.jsxs(L,{children:[x.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Ingen tidserie-data tillgänglig för vald sida"}):e.jsxs(e.Fragment,{children:[e.jsxs(Ve,{children:[e.jsx(Me,{children:e.jsxs(ge,{children:[e.jsx(fe,{className:"cursor-pointer select-none",onClick:()=>j("year_month"),children:e.jsxs("div",{className:"flex items-center",children:["Period",s("year_month")]})}),U.map(n=>{const c=Se[n];return e.jsx(fe,{className:"text-right cursor-pointer select-none",onClick:()=>j(n),children:e.jsxs("div",{className:"flex items-center justify-end",children:[(c==null?void 0:c.displayName)||n,s(n),!(c!=null&&c.canSumAcrossPages)&&e.jsx("span",{className:"ml-1 text-orange-600",children:"*"})]})},n)})]})}),e.jsx(Ie,{children:h.map((n,c)=>e.jsxs(ge,{children:[e.jsxs(pe,{className:"font-medium",children:[z(n.month)," ",n.year]}),U.map(g=>{var u,f;return e.jsx(pe,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[v(n.metrics[g]),((u=p==null?void 0:p.metrics[g])==null?void 0:u.bestMonth)&&p.metrics[g].bestMonth.year===n.year&&p.metrics[g].bestMonth.month===n.month&&e.jsx("span",{className:"text-yellow-600",title:"Bästa värde för denna sida",children:"🏆"}),((f=p==null?void 0:p.metrics[g])==null?void 0:f.worstMonth)&&p.metrics[g].worstMonth.year===n.year&&p.metrics[g].worstMonth.month===n.month&&e.jsx("span",{className:"text-gray-500",title:"Sämsta värde för denna sida",children:"📉"})]})},g)})]},`${n.year}_${n.month}`))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Visa:"}),e.jsxs(ve,{value:F.toString(),onValueChange:n=>{B(Number(n)),ae(1)},children:[e.jsx(je,{className:"w-[120px]",children:e.jsx(ye,{})}),e.jsx(Ne,{children:Ts.map(n=>e.jsx(be,{value:n.value.toString(),children:n.label},n.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Visar ",(A-1)*F+1," till ",Math.min(A*F,Y.length)," av ",Y.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",size:"sm",onClick:()=>ae(n=>Math.max(1,n-1)),disabled:A===1,children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:["Sida ",A," av ",b]}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>ae(n=>Math.min(b,n+1)),disabled:A>=b,children:e.jsx(Ge,{className:"h-4 w-4"})})]})]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-muted/30 rounded-lg",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"🏆 = Bästa värde för denna sida"}),e.jsx("span",{className:"mx-4",children:"📉 = Sämsta värde för denna sida"})]}),e.jsx("div",{className:"text-muted-foreground text-xs",children:"Gröna värden = bästa prestanda, röda värden = sämsta prestanda för vald tidsperiod"})]})})]})]})]})}const q={P1:"#0066cc",P2:"#ff6600",P3:"#00cc66",P4:"#cc33cc",EKOT:"#005eb8",RADIOSPORTEN:"#1c5c35",SR:"#000000",default:"#000000"},Ds=({pageName:r})=>{const t=r||"Okänd";let a=q.default,d="";const l=t.toLowerCase();l.includes("ekot")||l.includes("radio sweden")?(a=q.EKOT,d="E"):l.includes("radiosporten")||l.includes("radio sporten")?(a=q.RADIOSPORTEN,d="RS"):l.includes("p1")?(a=q.P1,d="P1"):l.includes("p2")?(a=q.P2,d="P2"):l.includes("p3")?(a=q.P3,d="P3"):l.includes("p4")?(a=q.P4,d="P4"):l.includes("sveriges radio")&&!l.includes("p1")&&!l.includes("p2")&&!l.includes("p3")&&!l.includes("p4")?(a=q.SR,d="SR"):d=t.charAt(0).toUpperCase();const y=a===q.P2||a===q.P3?"text-black":"text-white";return e.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-sm flex items-center justify-center text-xs font-bold ${y}`,style:{backgroundColor:a},title:r,children:d})},Es=[{value:10,label:"10 per sida"},{value:25,label:"25 per sida"},{value:50,label:"50 per sida"}],_s=[{key:"reach",label:"Räckvidd",canSum:!1},{key:"engagements",label:"Engagemang",canSum:!0},{key:"reactions",label:"Reaktioner",canSum:!0},{key:"publications",label:"Publiceringar",canSum:!0}],ce={reach:{displayName:"Räckvidd",canSumAcrossPages:!1,category:"unique_persons"},engagements:{displayName:"Engagemang",canSumAcrossPages:!0,category:"countable"},reactions:{displayName:"Reaktioner",canSumAcrossPages:!0,category:"countable"},publications:{displayName:"Publiceringar",canSumAcrossPages:!0,category:"countable"}};function Ls({uploadedPeriods:r=[]}){const[t,a]=o.useState(null),[d,l]=o.useState([]),[x,y]=o.useState(null),[$,M]=o.useState(!1),[k,w]=o.useState(null),[p,O]=o.useState({key:"pageName",direction:"asc"}),[R,X]=o.useState(1),[C,Q]=o.useState(25),[A,ae]=o.useState(["reach","engagements","publications"]);o.useEffect(()=>{if(r.length>0&&!t){const s=r[0];a({year:s.year,month:s.month})}},[r,t]),o.useEffect(()=>{if(!t)return;(()=>{try{M(!0),w(null);const i=r.find(N=>N.year===t.year&&N.month===t.month);if(!i){w(`Ingen data hittades för ${B(t.month)} ${t.year}`),l([]),y(null);return}const m=i.data.map(N=>({page:{pageName:N.Page||N.page||"Okänd sida",pageId:N["Page ID"]||N.pageId||"unknown"},period:{year:t.year,month:t.month},metrics:{reach:F(N.Reach||N.reach),engagements:F(N.Engagements||N.engagements),reactions:F(N.Reactions||N.reactions),publications:F(N.Publications||N.publications)}}));l(m);const v=U(m,t.year,t.month);y(v)}catch(i){console.error("Error loading period data:",i),w(`Kunde inte ladda data för ${B(t.month)} ${t.year}`)}finally{M(!1)}})()},[t,r]);const F=s=>{if(s==null||s==="")return 0;const i=parseFloat(String(s).replace(/[,\s]/g,""));return isNaN(i)?0:i},B=s=>["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"][s-1],U=(s,i,m)=>{if(!s.length)return null;const v={period:{year:i,month:m},totalPages:s.length,metrics:{}},N=["reach","engagements","reactions","publications"];for(const n of N){const c=s.map(u=>u.metrics[n]).filter(u=>u!=null&&!isNaN(u)&&u>=0);if(c.length===0){v.metrics[n]={total:0,average:0,min:0,max:0,validPages:0,type:ce[n].category};continue}if(!ce[n].canSumAcrossPages)v.metrics[n]={average:Math.round(c.reduce((u,f)=>u+f,0)/c.length),min:Math.min(...c),max:Math.max(...c),validPages:c.length,type:"unique_persons",note:"Genomsnitt över sidor - total reach kan inte beräknas"};else{const u=c.reduce((f,P)=>f+P,0);v.metrics[n]={total:u,average:Math.round(u/c.length),min:Math.min(...c),max:Math.max(...c),validPages:c.length,type:"countable"}}}return v},K=o.useMemo(()=>d.length?[...d].sort((s,i)=>{let m,v;if(p.key==="pageName"?(m=s.page.pageName,v=i.page.pageName):(m=s.metrics[p.key]||0,v=i.metrics[p.key]||0),typeof m=="string"){const n=m.localeCompare(v);return p.direction==="asc"?n:-n}const N=m-v;return p.direction==="asc"?N:-N}):[],[d,p]),H=o.useMemo(()=>{const s=(R-1)*C;return K.slice(s,s+C)},[K,R,C]),le=Math.ceil(K.length/C),z=s=>{O(i=>({key:s,direction:i.key===s&&i.direction==="asc"?"desc":"asc"}))},Y=s=>p.key!==s?e.jsx(Ze,{className:"h-4 w-4 ml-1 opacity-50"}):p.direction==="asc"?e.jsx(We,{className:"h-4 w-4 ml-1"}):e.jsx(Xe,{className:"h-4 w-4 ml-1"}),h=s=>{ae(i=>i.includes(s)?i.filter(m=>m!==s):[...i,s])},b=()=>{const s=["Sidnamn","Sido-ID",...A.map(g=>{const u=ce[g];return u?u.displayName:g})],i=K.map(g=>[g.page.pageName,g.page.pageId,...A.map(u=>g.metrics[u]||0)]),m=[s.join(","),...i.map(g=>g.join(","))].join(`
`),v=new Blob([m],{type:"text/csv;charset=utf-8;"}),N=document.createElement("a"),n=URL.createObjectURL(v);N.setAttribute("href",n);const c=t?`${B(t.month)}_${t.year}`:"månadsjämförelse";N.setAttribute("download",`Facebook_${c}.csv`),N.style.visibility="hidden",document.body.appendChild(N),N.click(),document.body.removeChild(N)},j=s=>s==null||isNaN(s)?"-":new Intl.NumberFormat("sv-SE").format(s);return $?e.jsxs(G,{children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsx(Z,{children:"Laddar data"}),e.jsx(W,{children:"Analyserar månadsdata för Facebook-sidor..."})]}):k?e.jsxs(G,{variant:"destructive",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(Z,{children:"Fel"}),e.jsx(W,{children:k})]}):r.length===0?e.jsxs(G,{children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(Z,{children:"Ingen data"}),e.jsx(W,{children:"Ladda upp CSV-filer för att visa månadsvis jämförelse av Facebook-sidor."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-facebook-500"}),"Månadsvis jämförelse"]})}),e.jsxs(L,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Välj månad"}),e.jsxs(ve,{value:t?`${t.year}_${t.month}`:"",onValueChange:s=>{const[i,m]=s.split("_");a({year:parseInt(i),month:parseInt(m)})},children:[e.jsx(je,{children:e.jsx(ye,{placeholder:"Välj månad att analysera"})}),e.jsx(Ne,{children:r.map(s=>e.jsxs(be,{value:`${s.year}_${s.month}`,children:[B(s.month)," ",s.year]},`${s.year}_${s.month}`))})]}),t&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Visar data för ",B(t.month)," ",t.year]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Metrics att visa"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:_s.map(s=>{const i=A.includes(s.key);return e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:()=>h(s.key),className:"h-4 w-4 text-facebook-500 border-gray-300 rounded focus:ring-facebook-500"}),e.jsx("span",{className:"text-sm font-medium",children:s.label}),!s.canSum&&e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"*"})]},s.key)})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"* = Kan inte summeras över sidor (unika personer per månad)"})]})]}),x&&e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6 p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-facebook-600",children:x.totalPages}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Facebook-sidor"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold",children:[B(x.period.month)," ",x.period.year]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Vald period"})]}),A.slice(0,2).map(s=>{const i=x.metrics[s],m=ce[s];return!i||!m?null:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:m.canSumAcrossPages?j(i.total):j(i.average)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:m.canSumAcrossPages?`Total ${m.displayName}`:`Snitt ${m.displayName}`})]},s)})]})]})]}),e.jsxs(D,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between",children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),t?`${B(t.month)} ${t.year} - Alla sidor`:"Månadsdata"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(V,{onClick:b,variant:"outline",size:"sm",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"CSV"]})})]}),e.jsxs(L,{children:[d.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Ingen data tillgänglig för vald månad"}):e.jsxs(e.Fragment,{children:[e.jsxs(Ve,{children:[e.jsx(Me,{children:e.jsxs(ge,{children:[e.jsx(fe,{className:"cursor-pointer select-none",onClick:()=>z("pageName"),children:e.jsxs("div",{className:"flex items-center",children:["Sidnamn",Y("pageName")]})}),A.map(s=>{const i=ce[s];return e.jsx(fe,{className:"text-right cursor-pointer select-none",onClick:()=>z(s),children:e.jsxs("div",{className:"flex items-center justify-end",children:[(i==null?void 0:i.displayName)||s,Y(s),!(i!=null&&i.canSumAcrossPages)&&e.jsx("span",{className:"ml-1 text-orange-600",children:"*"})]})},s)})]})}),e.jsx(Ie,{children:H.map((s,i)=>e.jsxs(ge,{children:[e.jsx(pe,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{pageName:s.page.pageName}),e.jsx("span",{children:s.page.pageName})]})}),A.map(m=>e.jsx(pe,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[j(s.metrics[m]),(x==null?void 0:x.metrics[m])&&s.metrics[m]===x.metrics[m].max&&x.metrics[m].max!==x.metrics[m].min&&e.jsx("span",{className:"text-yellow-600",title:"Bästa värde för denna månad",children:"🏆"}),(x==null?void 0:x.metrics[m])&&s.metrics[m]===x.metrics[m].min&&x.metrics[m].max!==x.metrics[m].min&&e.jsx("span",{className:"text-gray-500",title:"Lägsta värde för denna månad",children:"📉"})]})},m))]},s.page.pageId))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Visa:"}),e.jsxs(ve,{value:C.toString(),onValueChange:s=>{Q(Number(s)),X(1)},children:[e.jsx(je,{className:"w-[120px]",children:e.jsx(ye,{})}),e.jsx(Ne,{children:Es.map(s=>e.jsx(be,{value:s.value.toString(),children:s.label},s.value))})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Visar ",(R-1)*C+1," till ",Math.min(R*C,K.length)," av ",K.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",size:"sm",onClick:()=>X(s=>Math.max(1,s-1)),disabled:R===1,children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm",children:["Sida ",R," av ",le]}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>X(s=>Math.min(le,s+1)),disabled:R>=le,children:e.jsx(Ge,{className:"h-4 w-4"})})]})]})]})]}),A.some(s=>{var i;return((i=ce[s])==null?void 0:i.category)==="unique_persons"})&&e.jsxs(G,{className:"mt-4 bg-amber-50 border-amber-200",children:[e.jsx(ie,{className:"h-4 w-4 text-amber-600"}),e.jsx(Z,{className:"text-amber-800",children:"Viktigt om Räckvidd"}),e.jsx(W,{className:"text-amber-700",children:"Räckvidd representerar unika personer per månad och kan ALDRIG summeras över månader eller sidor. Värdena i tabellen visar data för den valda månaden."})]})]})]})]})}function Os(){const[r,t]=o.useState(!1),[a,d]=o.useState(!1),[l,x]=o.useState("upload"),[y,$]=o.useState([]),M=w=>{console.log("Data uploaded successfully:",w),$(w),t(!0),d(!1),x("monthly")},k=()=>{d(!1)};return a?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b border-border",children:e.jsx("div",{className:"container py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"facebook-brand flex items-center gap-3",children:[e.jsx(re,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Facebook API data analyser"})]}),e.jsxs(V,{variant:"outline",onClick:k,children:[e.jsx(js,{className:"mr-2 h-4 w-4"}),"Tillbaka"]})]})})}),e.jsx("main",{className:"container py-6",children:e.jsx(Vs,{onDataUploaded:M,onCancel:k})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b border-border",children:e.jsx("div",{className:"container py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"facebook-brand flex items-center gap-3",children:[e.jsx(re,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Facebook API data analyser"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Tidserie-baserad analys av månadsstatistik"})]})})}),e.jsx("main",{className:"container py-6",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(G,{variant:"info",className:"bg-facebook-50 border-facebook-200",children:[e.jsx(Ns,{className:"h-4 w-4 text-facebook-600"}),e.jsx(Z,{className:"text-facebook-800",children:"Välkommen till Facebook API data analyser"}),e.jsxs(W,{className:"text-facebook-700",children:[e.jsxs("p",{className:"mb-2",children:["Detta verktyg analyserar månadsdata från Facebook API i CSV-format. Ladda upp filer som följer namnkonventionen ",e.jsx("code",{className:"bg-white px-1 rounded",children:"FB_YYYY_MM.csv"}),"(t.ex. FB_2025_08.csv för Augusti 2025)."]}),e.jsx("p",{className:"font-medium",children:"VIKTIGT: Reach och Engaged Users kan aldrig summeras över månader (unika personer per månad)."})]})]}),r?e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-facebook-500"}),"Uppladdad data"]})}),e.jsxs(L,{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-facebook-600",children:y.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Månader"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-facebook-600",children:y.reduce((w,p)=>w+(p.pageCount||0),0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Totalt sidposter"})]}),e.jsx("div",{className:"text-center",children:e.jsxs(V,{variant:"outline",onClick:()=>d(!0),className:"w-full",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Ladda mer data"]})})]}),y.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Uppladdade perioder:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((w,p)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-facebook-50 text-facebook-700 border border-facebook-200",children:[w.displayName," (",w.pageCount," sidor)"]},p))})]})]})]}),e.jsxs(Ps,{value:l,onValueChange:x,children:[e.jsxs(ss,{className:"grid w-full grid-cols-4",children:[e.jsxs(xe,{value:"upload",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Ladda data"]}),e.jsxs(xe,{value:"monthly",children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Månadsanalys"]}),e.jsxs(xe,{value:"pages",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Sidanalys"]}),e.jsxs(xe,{value:"trends",children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Trender"]})]}),e.jsx(ue,{value:"upload",className:"mt-6",children:e.jsxs(D,{children:[e.jsx(E,{children:e.jsx(_,{children:"Hantera CSV-data"})}),e.jsxs(L,{className:"space-y-4",children:[e.jsx("p",{className:"text-muted-foreground",children:"Hantera dina uppladdade CSV-filer och ladda upp ytterligare månadsdata."}),e.jsxs(V,{onClick:()=>d(!0),children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Ladda upp mer data"]})]})]})}),e.jsx(ue,{value:"monthly",className:"mt-6",children:e.jsx(Ls,{uploadedPeriods:y})}),e.jsx(ue,{value:"pages",className:"mt-6",children:e.jsx(Fs,{uploadedPeriods:y})}),e.jsx(ue,{value:"trends",className:"mt-6",children:e.jsxs(D,{children:[e.jsx(E,{children:e.jsx(_,{children:"Trendanalys"})}),e.jsxs(L,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"TrendAnalysisView implementeras i FAS 7"}),y.length>1&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Trendanalys tillgänglig för ",y.length," månader"]})]})]})})]})]}):e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(D,{className:"timeseries-card",children:[e.jsxs(E,{className:"text-center",children:[e.jsx(me,{className:"h-16 w-16 mx-auto mb-4 text-facebook-500"}),e.jsx(_,{className:"text-2xl",children:"Börja med att ladda upp CSV-filer"}),e.jsx("p",{className:"text-muted-foreground",children:"Ladda upp en eller flera månads-CSV:er för att börja analysera Facebook-data över tid"})]}),e.jsx(L,{className:"text-center",children:e.jsxs(V,{variant:"facebook",size:"lg",onClick:()=>d(!0),children:[e.jsx(me,{className:"mr-2 h-5 w-5"}),"Ladda upp CSV-filer"]})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(D,{className:"opacity-50",children:[e.jsxs(E,{children:[e.jsx(he,{className:"h-8 w-8 text-facebook-500 mb-2"}),e.jsx(_,{className:"text-lg",children:"Månadsanalys"})]}),e.jsx(L,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Analysera prestanda för specifika månader och jämför mellan perioder"})})]}),e.jsxs(D,{className:"opacity-50",children:[e.jsxs(E,{children:[e.jsx(Pe,{className:"h-8 w-8 text-facebook-500 mb-2"}),e.jsx(_,{className:"text-lg",children:"Trendanalys"})]}),e.jsx(L,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upptäck trender och utvecklingsmönster över tid för alla Facebook-sidor"})})]}),e.jsxs(D,{className:"opacity-50",children:[e.jsxs(E,{children:[e.jsx(re,{className:"h-8 w-8 text-facebook-500 mb-2"}),e.jsx(_,{className:"text-lg",children:"Sidanalys"})]}),e.jsx(L,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Djupdyk i specifika Facebook-sidor och deras utveckling över månader"})})]})]})]})]})}),e.jsx("footer",{className:"border-t border-border mt-12",children:e.jsxs("div",{className:"container py-4 text-center text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Facebook API data analyser © ",new Date().getFullYear()]}),e.jsxs("p",{className:"mt-1",children:["Tidserie-baserad analys av månadsstatistik |",e.jsx("span",{className:"text-facebook-500 font-medium",children:" Utvecklad för projektfas 1-8"})]})]})})]})}Ae.createRoot(document.getElementById("root")).render(e.jsx(vs.StrictMode,{children:e.jsx(Os,{})}));
//# sourceMappingURL=index-Dq_mY8No.js.map
